<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="VBlogG"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="JPG to PDF Convertor in C#"><meta property="og:title" content="JPG to PDF Convertor in C#"><meta property="twitter:title" content="JPG to PDF Convertor in C#"><meta name=description content="I would like to convert from an image (like jpg or png) to PDF. I've checked out ImageMagickNET, but it is far too complex for my needs. What other .NET solutions or code are there for converting an image to a PDF?"><meta property="og:description" content="I would like to convert from an image (like jpg or png) to PDF. I've checked out ImageMagickNET, but it is far too complex for my needs. What other .NET solutions or code are there for converting an image to a PDF?"><meta property="twitter:description" content="I would like to convert from an image (like jpg or png) to PDF. I've checked out ImageMagickNET, but it is far too complex for my needs. What other .NET solutions or code are there for converting an image to a PDF?"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>JPG to PDF Convertor in C# |</title><link rel=canonical href=./jpg-to-pdf-convertor-in-c-sharp.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>VBlogG</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/blog>blog</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>JPG to PDF Convertor in C#</h1><h2 class=subheading></h2><span class=meta>Posted by
Martina Birk
on
Saturday, August 3, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><img src=https://cdn.statically.io/img/cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>I would like to convert from an image (like jpg or png) to PDF.</p><p>I've checked out <a href=# rel=noreferrer>ImageMagickNET</a>, but it is far too complex for my needs.</p><p>What other .NET solutions or code are there for converting an image to a PDF?</p><span class=d-none itemprop=commentCount>3</span><h2 class=mb0 data-answercount=11>11 Answers</h2><p>Easy with <a href=# rel=noreferrer>iTextSharp</a>:</p><pre><code>class Program { static void Main(string[] args) { Document document = new Document(); using (var stream = new FileStream("test.pdf", FileMode.Create, FileAccess.Write, FileShare.None)) { PdfWriter.GetInstance(document, stream); document.Open(); using (var imageStream = new FileStream("test.jpg", FileMode.Open, FileAccess.Read, FileShare.ReadWrite)) { var image = Image.GetInstance(imageStream); document.Add(image); } document.Close(); } } } </code></pre><span class=d-none itemprop=commentCount>4</span><p><a href=# rel=noreferrer>iTextSharp</a> does it pretty cleanly and is open source. Also, it has <a href=# rel=noreferrer>a very good accompanying book by the author</a> which I recommend if you end up doing more interesting things like managing forms. For normal usage, there are plenty resources on mailing lists and newsgroups for samples of how to do common things.</p><p>EDIT: as alluded to in <a href=#>@Chirag's comment</a>, <a href=#>@Darin's answer</a> has code that definitely compiles with current versions.</p><p>Example usage:</p><pre><code>public static void ImagesToPdf(string[] imagepaths, string pdfpath) { using(var doc = new iTextSharp.text.Document()) { iTextSharp.text.pdf.PdfWriter.GetInstance(doc, new FileStream(pdfpath, FileMode.Create)); doc.Open(); foreach (var item in imagepaths) { iTextSharp.text.Image image = iTextSharp.text.Image.GetInstance(item); doc.Add(image); } } } </code></pre><span class=d-none itemprop=commentCount>5</span><p>Another working code, try it</p><pre><code>public void ImagesToPdf(string[] imagepaths, string pdfpath) { iTextSharp.text.Rectangle pageSize = null; using (var srcImage = new Bitmap(imagepaths[0].ToString())) { pageSize = new iTextSharp.text.Rectangle(0, 0, srcImage.Width, srcImage.Height); } using (var ms = new MemoryStream()) { var document = new iTextSharp.text.Document(pageSize, 0, 0, 0, 0); iTextSharp.text.pdf.PdfWriter.GetInstance(document, ms).SetFullCompression(); document.Open(); var image = iTextSharp.text.Image.GetInstance(imagepaths[0].ToString()); document.Add(image); document.Close(); File.WriteAllBytes(pdfpath+"cheque.pdf", ms.ToArray()); } } </code></pre><span class=d-none itemprop=commentCount>1</span><p>One we've had great luck with is PDFSharp (we use it for TIFF and Text to PDF conversion for hundreds of medical claims every day).</p><p><a href=# rel=noreferrer>http://pdfsharp.com/PDFsharp/</a></p><span class=d-none itemprop=commentCount>1</span><p>Such task can be easily done with help of <a href=# rel="nofollow noreferrer">Docotic.Pdf library</a>.</p><p>Here is a sample that creates PDF from given images (not only JPGs, actually):</p><pre><code>public static void imagesToPdf(string[] images, string pdfName) { using (PdfDocument pdf = new PdfDocument()) { for (int i = 0; i &lt; images.Length; i++) { if (i &gt; 0) pdf.AddPage(); PdfPage page = pdf.Pages[i]; string imagePath = images[i]; PdfImage pdfImage = pdf.AddImage(imagePath); page.Width = pdfImage.Width; page.Height = pdfImage.Height; page.Canvas.DrawImage(pdfImage, 0, 0); } pdf.Save(pdfName); } } </code></pre><p>Disclaimer: I work for the vendor of the library.</p><span class=d-none itemprop=commentCount></span><p>If you want to do it in a cross-platform way, without any thirty part library, or paying any license, you can use this code. It takes an array of pictures (I think it only works only with jpg) with its sizes and return a pdf file, with one picture per page.</p><p>You have to create two files:</p><p>File Picture:</p><pre><code>using System; using System.Collections.Generic; using System.Text; namespace PDF { public class Picture { private byte[] data; private int width; private int height; public byte[] Data { get =&gt; data; set =&gt; data = value; } public int Width { get =&gt; width; set =&gt; width = value; } public int Height { get =&gt; height; set =&gt; height = value; } } } </code></pre><p>File PDFExport:</p><pre><code>using System; using System.Collections.Generic; namespace PDF { public class PDFExport { private string company = "Your Company Here"; public sbyte[] createFile(List&lt;Picture&gt; pictures) { int N = (pictures.Count + 1) * 3; string dateTimeStr = DateTime.Now.ToString("yyyyMMddhhmmss"); string file1 = "%PDF-1.4\n"; string file2 = "2 0 obj\n" + "&lt;&lt;\n" + "/Type /Pages\n" + getKids(pictures) + "/Count " + pictures.Count + "\n" + "&gt;&gt;\n" + "endobj\n" + "1 0 obj\n" + "&lt;&lt;\n" + "/Type /Catalog\n" + "/Pages 2 0 R\n" + "/PageMode /UseNone\n" + "/PageLayout /SinglePage\n" + "/Metadata 7 0 R\n" + "&gt;&gt;\n" + "endobj\n" + N + " 0 obj\n" + "&lt;&lt;\n" + "/Creator(" + company + ")\n" + "/Producer(" + company + ")\n" + "/CreationDate (D:" + dateTimeStr + ")\n" + "/ModDate (D:" + dateTimeStr + ")\n" + "&gt;&gt;\n" + "endobj\n" + "xref\n" + "0 " + (N + 1) + "\n" + "0000000000 65535 f\n" + "0000224088 00000 n\n" + "0000224031 00000 n\n" + "0000000015 00000 n\n" + "0000222920 00000 n\n" + "0000222815 00000 n\n" + "0000224153 00000 n\n" + "0000223050 00000 n\n" + "trailer\n" + "&lt;&lt;\n" + "/Size " + (N + 1) + "\n" + "/Root 1 0 R\n" + "/Info 6 0 R\n" + "&gt;&gt;\n" + "startxref\n" + "0\n" + "%% EOF"; sbyte[] part1 = file1.GetBytes(); sbyte[] part2 = file2.GetBytes(); List&lt;sbyte[]&gt; fileContents = new List&lt;sbyte[]&gt;(); fileContents.Add(part1); for (int i = 0; i &lt; pictures.Count; i++) { fileContents.Add(getPageFromImage(pictures[i], i)); } fileContents.Add(part2); return getFileContent(fileContents); } private string getKids(List&lt;Picture&gt; pictures) { string kids = "/Kids["; for (int i = 0; i &lt; pictures.Count; i++) { kids += (3 * (i + 1) + 1) + " 0 R "; } kids += "]\n"; return kids; } private sbyte[] getPageFromImage(Picture picture, int P) { int N = (P + 1) * 3; string imageStart = N + " 0 obj\n" + "&lt;&lt;\n" + "/Type /XObject\n" + "/Subtype /Image\n" + "/Width " + picture.Width + "\n" + "/Height " + picture.Height + "\n" + "/BitsPerComponent 8\n" + "/ColorSpace /DeviceRGB\n" + "/Filter /DCTDecode\n" + "/Length " + picture.Data.Length + "\n" + "&gt;&gt;\n" + "stream\n"; string dimentions = "q\n" + picture.Width + " 0 0 " + picture.Height + " 0 0 cm\n" + "/X0 Do\n" + "Q\n"; string imageEnd = "\nendstream\n" + "endobj\n" + (N + 2) + " 0 obj\n" + "&lt;&lt;\n" + "/Filter []\n" + "/Length " + dimentions.Length + "\n" + "&gt;&gt;\n" + "stream\n"; string page = "\nendstream\n" + "endobj\n" + (N + 1) + " 0 obj\n" + "&lt;&lt;\n" + "/Type /Page\n" + "/MediaBox[0 0 " + picture.Width + " " + picture.Height + "]\n" + "/Resources &lt;&lt;\n" + "/XObject &lt;&lt;\n" + "/X0 " + N + " 0 R\n" + "&gt;&gt;\n" + "&gt;&gt;\n" + "/Contents 5 0 R\n" + "/Parent 2 0 R\n" + "&gt;&gt;\n" + "endobj\n"; List&lt;sbyte[]&gt; fileContents = new List&lt;sbyte[]&gt;(); fileContents.Add(imageStart.GetBytes()); fileContents.Add(byteArrayToSbyteArray(picture.Data)); fileContents.Add(imageEnd.GetBytes()); fileContents.Add(dimentions.GetBytes()); fileContents.Add(page.GetBytes()); return getFileContent(fileContents); } private sbyte[] byteArrayToSbyteArray(byte[] data) { sbyte[] data2 = new sbyte[data.Length]; for (int i = 0; i &lt; data2.Length; i++) { data2[i] = (sbyte)data[i]; } return data2; } private sbyte[] getFileContent(List&lt;sbyte[]&gt; fileContents) { int fileSize = 0; foreach (sbyte[] content in fileContents) { fileSize += content.Length; } sbyte[] finaleFile = new sbyte[fileSize]; int index = 0; foreach (sbyte[] content in fileContents) { for (int i = 0; i &lt; content.Length; i++) { finaleFile[index + i] = content[i]; } index += content.Length; } return finaleFile; } } } </code></pre><p>You can use the code in this easy way</p><p>///////////////////////////////////////Export PDF//////////////////////////////////////</p><pre><code> private sbyte[] exportPDF(List&lt;Picture&gt; images) { if (imageBytesList.Count &gt; 0) { PDFExport pdfExport = new PDFExport(); sbyte[] fileData = pdfExport.createFile(images); return fileData; } return null; } </code></pre><span class=d-none itemprop=commentCount></span><p>You need Acrobat to be installed. Tested on Acrobat DC. This is a VB.net code. Due to that these objects are COM objects, you shall do a 'release object', not just a '=Nothing". You can convert this code here: <a href=# rel="nofollow noreferrer">https://converter.telerik.com/</a></p><pre class="lang-vb prettyprint-override"><code>Private Function ImageToPDF(ByVal FilePath As String, ByVal DestinationFolder As String) As String Const PDSaveCollectGarbage As Integer = 32 Const PDSaveLinearized As Integer = 4 Const PDSaveFull As Integer = 1 Dim PDFAVDoc As Object = Nothing Dim PDFDoc As Object = Nothing Try 'Check destination requirements If Not DestinationFolder.EndsWith("\") Then DestinationFolder += "\" If Not System.IO.Directory.Exists(DestinationFolder) Then Throw New Exception("Destination directory does not exist: " &amp; DestinationFolder) Dim CreatedFile As String = DestinationFolder &amp; System.IO.Path.GetFileNameWithoutExtension(FilePath) &amp; ".pdf" 'Avoid conflicts, therefore previous file there will be deleted If File.Exists(CreatedFile) Then File.Delete(CreatedFile) 'Get PDF document PDFAVDoc = GetPDFAVDoc(FilePath) PDFDoc = PDFAVDoc.GetPDDoc If Not PDFDoc.Save(PDSaveCollectGarbage Or PDSaveLinearized Or PDSaveFull, CreatedFile) Then Throw New Exception("PDF file cannot be saved: " &amp; PDFDoc.GetFileName()) If Not PDFDoc.Close() Then Throw New Exception("PDF file could not be closed: " &amp; PDFDoc.GetFileName()) PDFAVDoc.Close(1) Return CreatedFile Catch Ex As Exception Throw Ex Finally System.Runtime.InteropServices.Marshal.ReleaseComObject(PDFDoc) System.Runtime.InteropServices.Marshal.FinalReleaseComObject(PDFDoc) PDFDoc = Nothing System.Runtime.InteropServices.Marshal.ReleaseComObject(PDFAVDoc) System.Runtime.InteropServices.Marshal.FinalReleaseComObject(PDFAVDoc) PDFAVDoc = Nothing GC.Collect() GC.WaitForPendingFinalizers() GC.Collect() End Try End Function </code></pre><span class=d-none itemprop=commentCount></span><p>not sure if you're looking for just free / open source solutions or considering commercial ones as well. But if you're including commercial solutions, there's a toolkit called EasyPDF SDK that offers an API for converting images (plus a number of other file types) to PDF. It supports C# and can be found here:</p><pre><code> http://www.pdfonline.com/ </code></pre><p>The C# code would look as follows:</p><pre><code> Printer oPrinter = new Printer(); ImagePrintJob oPrintJob = oPrinter.ImagePrintJob; oPrintJob.PrintOut(imageFile, pdfFile); </code></pre><p>To be fully transparent, I should disclaim that I do work for the makers of EasyPDF SDK (hence my handle), so this suggestion is not without some personal bias :) But feel free to check out the eval version if you're interested. Cheers!</p><span class=d-none itemprop=commentCount></span><p>I use Sautinsoft, its very simple:</p><pre><code>SautinSoft.PdfMetamorphosis p = new SautinSoft.PdfMetamorphosis(); p.Serial="xxx"; p.HtmlToPdfConvertStringToFile("&lt;html&gt;&lt;body&gt;&lt;img src=\""+filename+"\"&gt;&lt;/img&gt;&lt;/body&gt;&lt;/html&gt;","output.pdf"); </code></pre><span class=d-none itemprop=commentCount></span><p>You may try to convert any Images to PDF using this code sample:</p><pre><code>PdfVision v = new PdfVision(); ImageToPdfOptions options = new ImageToPdfOptions(); options.JpegQuality = 95; try { v.ConvertImageToPdf(new string[] {inpFile}, outFile, options); System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(outFile) { UseShellExecute = true }); } catch (Exception ex) { Console.WriteLine($"Error: {ex.Message}"); Console.ReadLine(); } </code></pre><p>Or if you need to convert Image Class to PDF:</p><pre><code>System.Drawing.Image image = Image.FromFile(@"..\..\image-jpeg.jpg"); string outFile = new FileInfo(@"Result.pdf").FullName; PdfVision v = new PdfVision(); ImageToPdfOptions options = new ImageToPdfOptions(); options.PageSetup.PaperType = PaperType.Auto; byte[] imgBytes = null; using (MemoryStream ms = new System.IO.MemoryStream()) { image.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg); imgBytes = ms.ToArray(); } try { v.ConvertImageToPdf(imgBytes, outFile, options); System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo(outFile) { UseShellExecute = true }); } catch (Exception ex) { Console.WriteLine($"Error: {ex.Message}"); Console.ReadLine(); } </code></pre><span class=d-none itemprop=commentCount></span><p>Many diff tools out there. One I use is PrimoPDF (FREE) <a href=# rel="nofollow noreferrer">http://www.primopdf.com/</a> you go to print the file and you print it to pdf format onto your drive. works on Windows</p><span class=d-none itemprop=commentCount>1</span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJoaG9sYmeFcXvJqZ5mrJ9ivaWyjJymp66Vp8GwvoyipWabXai1or7P</p><hr><ul class=pager><li class=previous><a href=./ralo-finally-receives-court-date-after-4-years-in-jail.html data-toggle=tooltip data-placement=top title="Ralo Finally Receives Court Date After 4 Years In Jail">&larr;
Previous Post</a></li><li class=next><a href=./chas-mccormick-parents.html data-toggle=tooltip data-placement=top title="Chas McCormick Parents, Siblings, Wife, Position, Salary, Net Worth, Education, Real Name, Height &amp;amp; ">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; VBlogG 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://iklan.listspress.com/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>